<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="mk-passby的博客">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        Spring 工厂 - mk-passby的博客 | mk-passby&#39;s Blog
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> 我想回头望  把故事从头讲~ </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar">
            <img src="/img/avatar.jpg" />
        </div>
        <div class="name">
            <i>mk-passby</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>主页</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>标签</span>
                </a>
            </li>
            <li >
                <a href="/archive">
                    <i class="iconfont icon-guidang2"></i>
                    <span>存档</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>关于</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>搜索</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring-工厂"><span class="toc-text">Spring 工厂</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#创建对象"><span class="toc-text">创建对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#将对象的创建交给工厂"><span class="toc-text">将对象的创建交给工厂</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#怎么处理类的统一管理呢？"><span class="toc-text">怎么处理类的统一管理呢？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#至此，我们的完整代码如下："><span class="toc-text">至此，我们的完整代码如下：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#spring怎么获取bean对象的呢"><span class="toc-text">spring怎么获取bean对象的呢</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#依赖jar包"><span class="toc-text">依赖jar包</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#创建xml配置文件"><span class="toc-text">创建xml配置文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#编写测试类测试"><span class="toc-text">编写测试类测试</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#spring工厂的本质"><span class="toc-text">spring工厂的本质</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ApplicationContext工厂"><span class="toc-text">ApplicationContext工厂</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ApplicationContext接⼝类型"><span class="toc-text">ApplicationContext接⼝类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ApplicationContext常用API"><span class="toc-text">ApplicationContext常用API</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#配置⽂件中需要注意的细节"><span class="toc-text">配置⽂件中需要注意的细节</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#开发过程中，所有的对象都交给Spring⼯⼚来创建？"><span class="toc-text">开发过程中，所有的对象都交给Spring⼯⼚来创建？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring5-x与⽇志框架的整合"><span class="toc-text">Spring5.x与⽇志框架的整合</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Spring如何整合⽇志框架"><span class="toc-text">Spring如何整合⽇志框架</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#注⼊-Injection"><span class="toc-text">注⼊(Injection)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#如何进⾏注⼊"><span class="toc-text">如何进⾏注⼊</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#常用的注入方式"><span class="toc-text">常用的注入方式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#JDK类型"><span class="toc-text">JDK类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#⽤户⾃定义类型"><span class="toc-text">⽤户⾃定义类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Set注⼊的简化写法"><span class="toc-text">Set注⼊的简化写法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#构造注⼊"><span class="toc-text">构造注⼊</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring⼯⼚创建复杂对象"><span class="toc-text">Spring⼯⼚创建复杂对象</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Spring⼯⼚创建复杂对象的3种⽅式"><span class="toc-text">Spring⼯⼚创建复杂对象的3种⽅式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-FactoryBean接⼝"><span class="toc-text">1.FactoryBean接⼝</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-实例⼯⼚"><span class="toc-text">2.实例⼯⼚</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-静态⼯⼚"><span class="toc-text">3.静态⼯⼚</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#控制Spring⼯⼚创建对象的次数"><span class="toc-text">控制Spring⼯⼚创建对象的次数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#简单对象的创建次数"><span class="toc-text">简单对象的创建次数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#复杂对象的创建次数"><span class="toc-text">复杂对象的创建次数</span></a></li></ol></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">搜索</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>
        <div class="index-about-mobile">
            <i> 我想回头望  把故事从头讲~ </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        Spring 工厂
    </div>

    <div class="post-meta">
        <span class="attr">发布于：<span>2020-09-12 11:44:00</span></span>
        
        <span class="attr">标签：/
        
        <a class="tag" href="/tags/#spring" title="spring">spring</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">访问：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content ">
        <h2 id="Spring-工厂"><a href="#Spring-工厂" class="headerlink" title="Spring 工厂"></a>Spring 工厂</h2><p>1.传统的创建对象的方式为直接new一个对象，这样导致对象间耦合度高，如果对象发生变化，则需要到处修改。这样导致很多时候我们只是想在不同的地方调用对象的方法，但是不得不重复创建对象。</p>
<h3 id="创建对象"><a href="#创建对象" class="headerlink" title="创建对象"></a>创建对象</h3><p>这里列举两个对象的创建方式(不止这两个，序列化，克隆等都是，这里我们只介绍new和反射)</p>
<ul>
<li>直接new创建对象</li>
<li>反射创建对象</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mk.learn.spring.ioc.factory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mk.learn.spring.ioc.<span class="keyword">module</span>.User;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@program</span>: learning-demo</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>:</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: mk_passby</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span>: 2020-08-27 22:40</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ClassNotFoundException, InstantiationException, IllegalAccessException </span>&#123;</span><br><span class="line">        <span class="comment">//直接new创建对象</span></span><br><span class="line">        <span class="comment">//User user=new User();</span></span><br><span class="line">        Test test = <span class="keyword">new</span> Test();</span><br><span class="line">        <span class="comment">//反射创建对象</span></span><br><span class="line">        User user = test.createUserByRefle();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> User <span class="title">createUserByRefle</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ClassNotFoundException, IllegalAccessException, InstantiationException </span>&#123;</span><br><span class="line">        <span class="comment">//创建普通对象</span></span><br><span class="line">        <span class="keyword">return</span> (User) Class.forName(<span class="string">"com.mk.learn.spring.ioc.module.User"</span>).newInstance();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样直接看两种创建方式似乎没什么差别，但是如果将<code>&quot;com.mk.learn.spring.ioc.module.User&quot;</code>这部分内容提出来呢。使用工厂模式，于是有了下面的变形</p>
<h3 id="将对象的创建交给工厂"><a href="#将对象的创建交给工厂" class="headerlink" title="将对象的创建交给工厂"></a>将对象的创建交给工厂</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mk.learn.spring.ioc.factory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@program</span>: learning-demo</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>:</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: mk_passby</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span>: 2020-08-17 21:10</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NormalFactory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">createObjectByRefle</span><span class="params">(String className)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ClassNotFoundException, IllegalAccessException, InstantiationException </span>&#123;</span><br><span class="line">        <span class="comment">//创建普通对象</span></span><br><span class="line">        <span class="keyword">return</span> Class.forName(className).newInstance();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>于是对象的创建就通过如下的方式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User user1 = (User) NormalFactory.createObjectByRefle(User.class.getName());</span><br></pre></td></tr></table></figure>
<p><strong>思考该创建方式</strong></p>
<ul>
<li>为什么这里createObjectByRefle要用Object做返回值不用User对象呢？如果用User对象都不用强转不是更方便吗？<ul>
<li>如果使用User对象做返回值<font color="#FF0000">扩展性极差</font>，假设有一个UserA对象需要用工厂创建，就需要新增一个创建UserA的方法。这样导致工厂类臃肿。使用Object做返回值则更优雅。</li>
</ul>
</li>
</ul>
<p>但是这里又有一个问题，这里工厂创建的对象不够灵活。NormalFactory对象强依赖User.class.getName()。既然已经强依赖了，那么怎么思考下是不是需要统一管理呢？</p>
<h3 id="怎么处理类的统一管理呢？"><a href="#怎么处理类的统一管理呢？" class="headerlink" title="怎么处理类的统一管理呢？"></a>怎么处理类的统一管理呢？</h3><p>这里我们可以通过配置文件统一管理类名。</p>
<p>这里使用properties举例：</p>
<p>在resources下新增factoryObject.properties</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user=com.mk.learn.spring.ioc.module.User</span><br></pre></td></tr></table></figure>
<p>那么我们的工厂类进一步变为如下的方式创建：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">createObjectByProperties</span><span class="params">(String name)</span></span></span><br><span class="line"><span class="function">       <span class="keyword">throws</span> ClassNotFoundException, IllegalAccessException, InstantiationException, IOException </span>&#123;</span><br><span class="line">       InputStream</span><br><span class="line">           inputStream =</span><br><span class="line">           NormalFactory.class.getResourceAsStream(<span class="string">"/factoryObject.properties"</span>);</span><br><span class="line">       Properties properties=<span class="keyword">new</span> Properties();</span><br><span class="line">       properties.load(inputStream);</span><br><span class="line"></span><br><span class="line">           <span class="comment">//创建普通对象</span></span><br><span class="line">       <span class="keyword">return</span> Class.forName(properties.getProperty(name)).newInstance();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>我们创建对象的方式可以改用如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User user2 = (User) NormalFactory.createObjectByProperties(<span class="string">"user"</span>);</span><br></pre></td></tr></table></figure>
<h3 id="至此，我们的完整代码如下："><a href="#至此，我们的完整代码如下：" class="headerlink" title="至此，我们的完整代码如下："></a>至此，我们的完整代码如下：</h3><ul>
<li>NormalFactory普通工厂</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mk.learn.spring.ioc.factory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@program</span>: learning-demo</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>:</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: mk_passby</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span>: 2020-08-17 21:10</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NormalFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过工厂创建对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> className</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ClassNotFoundException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IllegalAccessException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> InstantiationException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">createObjectByRefle</span><span class="params">(String className)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ClassNotFoundException, IllegalAccessException, InstantiationException </span>&#123;</span><br><span class="line">        <span class="comment">//创建普通对象</span></span><br><span class="line">        <span class="keyword">return</span> Class.forName(className).newInstance();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过工厂+properties创建对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ClassNotFoundException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IllegalAccessException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> InstantiationException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">createObjectByProperties</span><span class="params">(String name)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ClassNotFoundException, IllegalAccessException, InstantiationException, IOException </span>&#123;</span><br><span class="line">        InputStream</span><br><span class="line">            inputStream =</span><br><span class="line">            NormalFactory.class.getResourceAsStream(<span class="string">"/factoryObject.properties"</span>);</span><br><span class="line">        Properties properties=<span class="keyword">new</span> Properties();</span><br><span class="line">        properties.load(inputStream);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//创建普通对象</span></span><br><span class="line">        <span class="keyword">return</span> Class.forName(properties.getProperty(name)).newInstance();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Test测试类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mk.learn.spring.ioc.factory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mk.learn.spring.ioc.<span class="keyword">module</span>.User;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@program</span>: learning-demo</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>:</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: mk_passby</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span>: 2020-08-27 22:40</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ClassNotFoundException, InstantiationException, IllegalAccessException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">//直接new创建对象</span></span><br><span class="line">        <span class="comment">//User user=new User();</span></span><br><span class="line">        Test test = <span class="keyword">new</span> Test();</span><br><span class="line">        System.out.println(<span class="string">"通过new获取对象："</span> + test);</span><br><span class="line">        System.out.println(test);</span><br><span class="line">        <span class="comment">//反射创建对象</span></span><br><span class="line">        User user = test.createUserByRefle();</span><br><span class="line">        System.out.println(<span class="string">"通过反射获取对象："</span> + user);</span><br><span class="line">        <span class="comment">//反射工厂创建对象</span></span><br><span class="line">        User user1 = (User) NormalFactory.createObjectByRefle(User.class.getName());</span><br><span class="line">        System.out.println(<span class="string">"通过工厂反射获取对象："</span> + user1);</span><br><span class="line">        <span class="comment">//反射工厂+properties创建对象</span></span><br><span class="line">        User user2 = (User) NormalFactory.createObjectByProperties(<span class="string">"user"</span>);</span><br><span class="line">        System.out.println(<span class="string">"通过properties获取对象："</span> + user2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> User <span class="title">createUserByRefle</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ClassNotFoundException, IllegalAccessException, InstantiationException </span>&#123;</span><br><span class="line">        <span class="comment">//创建普通对象</span></span><br><span class="line">        <span class="keyword">return</span> (User) Class.forName(<span class="string">"com.mk.learn.spring.ioc.module.User"</span>).newInstance();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>user对象</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mk.learn.spring.ioc.<span class="keyword">module</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@program</span>: learning-demo</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>:</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: mk_passby</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span>: 2020-08-25 22:20</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="spring怎么获取bean对象的呢"><a href="#spring怎么获取bean对象的呢" class="headerlink" title="spring怎么获取bean对象的呢"></a>spring怎么获取bean对象的呢</h3><h4 id="依赖jar包"><a href="#依赖jar包" class="headerlink" title="依赖jar包"></a>依赖jar包</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>learning-demo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.learn.mk<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-demo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="创建xml配置文件"><a href="#创建xml配置文件" class="headerlink" title="创建xml配置文件"></a>创建xml配置文件</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"com.mk.learn.spring.ioc.module.User"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="编写测试类测试"><a href="#编写测试类测试" class="headerlink" title="编写测试类测试"></a>编写测试类测试</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mk.learn.spring.ioc.spring;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mk.learn.spring.ioc.<span class="keyword">module</span>.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@program</span>: learning-demo</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>:</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: mk_passby</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span>: 2020-09-13 20:34</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringBeanTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ApplicationContext applicationContext=<span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"springBean.xml"</span>);</span><br><span class="line">        User user = (User) applicationContext.getBean(<span class="string">"user"</span>);</span><br><span class="line">        System.out.println(<span class="string">"通过spring创建Bean"</span>+user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">通过spring创建Beancom.mk.learn.spring.ioc.module.User@77caeb3e</span><br><span class="line"></span><br><span class="line">Process finished with exit code 0</span><br></pre></td></tr></table></figure>
<h3 id="spring工厂的本质"><a href="#spring工厂的本质" class="headerlink" title="spring工厂的本质"></a>spring工厂的本质</h3><p>结合前面springbean的创建方式和对象由工厂创建的思维。可以得到我们spring工厂的本质就是工厂模式。</p>
<p>即：</p>
<ul>
<li>ApplicationContext⼯⼚ +springBean.xml配置文件</li>
</ul>
<h2 id="ApplicationContext工厂"><a href="#ApplicationContext工厂" class="headerlink" title="ApplicationContext工厂"></a>ApplicationContext工厂</h2><h3 id="ApplicationContext接⼝类型"><a href="#ApplicationContext接⼝类型" class="headerlink" title="ApplicationContext接⼝类型"></a>ApplicationContext接⼝类型</h3><ul>
<li>接⼝：屏蔽实现的差异</li>
<li>⾮web环境的实现类 ：ClassPathXmlApplicationContext(main junit)</li>
<li>web环境的实现类 ：XmlWebApplicationContext</li>
</ul>
<h3 id="ApplicationContext常用API"><a href="#ApplicationContext常用API" class="headerlink" title="ApplicationContext常用API"></a>ApplicationContext常用API</h3><table>
<thead>
<tr>
<th>方法</th>
<th>介绍</th>
</tr>
</thead>
<tbody>
<tr>
<td>getBean(String name, Class<t> requiredType)</t></td>
<td>通过这种⽅式获得对象，就不需要强制类型转换</td>
</tr>
<tr>
<td>getBean(Class<t> requiredType)</t></td>
<td>当前Spring的配置⽂件中 只能有⼀个bean class是Person类型</td>
</tr>
<tr>
<td>getBeanDefinitionNames()</td>
<td>获取的是 Spring⼯⼚配置⽂件中所有bean标签的id值</td>
</tr>
<tr>
<td>getBeanNamesForType(@Nullable Class&lt;?&gt; type)</td>
<td>根据类型获得Spring配置⽂件中对应的id值</td>
</tr>
<tr>
<td>containsBeanDefinition(String beanName)</td>
<td>⽤于判断是否存在指定id值得bean,不能判断name值</td>
</tr>
<tr>
<td>containsBean(String beanName)</td>
<td>⽤于判断是否存在指定id值得bean,能判断name值</td>
</tr>
</tbody>
</table>
<h2 id="配置⽂件中需要注意的细节"><a href="#配置⽂件中需要注意的细节" class="headerlink" title="配置⽂件中需要注意的细节"></a>配置⽂件中需要注意的细节</h2><ul>
<li>只配置class属性,得到的id是com.mk.learn.spring.ioc.module.Dog#0<ul>
<li>如果需要被其他bean引用需要配置上这个id</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"com.mk.learn.spring.ioc.module.Dog"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>name属性<ul>
<li>⽤于在Spring的配置⽂件中，为bean对象定义别名。</li>
<li>id是唯一值，只能有一个，但是别名可以定义多个。</li>
</ul>
</li>
</ul>
<h2 id="开发过程中，所有的对象都交给Spring⼯⼚来创建？"><a href="#开发过程中，所有的对象都交给Spring⼯⼚来创建？" class="headerlink" title="开发过程中，所有的对象都交给Spring⼯⼚来创建？"></a>开发过程中，所有的对象都交给Spring⼯⼚来创建？</h2><ul>
<li>理论上 是的，但是有特例 ：实体对象(entity)是不会交给Spring创建，它是由持久层框架进⾏创建</li>
</ul>
<h2 id="Spring5-x与⽇志框架的整合"><a href="#Spring5-x与⽇志框架的整合" class="headerlink" title="Spring5.x与⽇志框架的整合"></a>Spring5.x与⽇志框架的整合</h2><ul>
<li>Spring与⽇志框架进⾏整合，⽇志框架就可以在控制台中，输出Spring框架运⾏过程中的⼀些重要的信息。</li>
<li>好处：便于了解Spring框架的运⾏过程，利于程序的调试</li>
</ul>
<h3 id="Spring如何整合⽇志框架"><a href="#Spring如何整合⽇志框架" class="headerlink" title="Spring如何整合⽇志框架"></a>Spring如何整合⽇志框架</h3><ul>
<li><p>引⼊log4j jar包</p>
<ul>
<li>POM文件</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4jlog4j12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.25<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>log4j.properties，放在resources目录下</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">### 配置根</span><br><span class="line">log4j.rootLogger =debug,console</span><br><span class="line">### ⽇志输出到控制台显示</span><br><span class="line">log4j.appender.console=org.apache.log4j.ConsoleAppender</span><br><span class="line">log4j.appender.console.Target=System.out</span><br><span class="line">log4j.appender.console.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.console.layout.ConversionPattern=%d&#123;yyyy-MM-dd HH:mm:ss&#125; %-5p %c&#123;1&#125;:%L - %m%n</span><br></pre></td></tr></table></figure>
<p>运行结果如下：</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">2020-09-13 21:29:09 DEBUG ClassPathXmlApplicationContext:590 - Refreshing org.springframework.context.support.ClassPathXmlApplicationContext@1edf1c96</span><br><span class="line">2020-09-13 21:29:09 DEBUG XmlBeanDefinitionReader:395 - Loaded 3 bean definitions from class path resource [springBean.xml]</span><br><span class="line">2020-09-13 21:29:09 DEBUG DefaultListableBeanFactory:213 - Creating shared instance of singleton bean 'user'</span><br><span class="line">2020-09-13 21:29:09 DEBUG DefaultListableBeanFactory:213 - Creating shared instance of singleton bean 'user1'</span><br><span class="line">2020-09-13 21:29:09 DEBUG DefaultListableBeanFactory:213 - Creating shared instance of singleton bean 'com.mk.learn.spring.ioc.module.Dog#0'</span><br><span class="line">通过spring创建Beancom.mk.learn.spring.ioc.module.User@1f36e637</span><br><span class="line">BeanDefinitionName is:user</span><br><span class="line">BeanDefinitionName is:user1</span><br><span class="line">BeanDefinitionName is:com.mk.learn.spring.ioc.module.Dog#0</span><br><span class="line">beanNamesForType = user</span><br><span class="line">beanNamesForType = user1</span><br></pre></td></tr></table></figure>
<h2 id="注⼊-Injection"><a href="#注⼊-Injection" class="headerlink" title="注⼊(Injection)"></a>注⼊(Injection)</h2><ul>
<li>通过编码的⽅式，为成员变量进⾏赋值，存在耦合</li>
</ul>
<h3 id="如何进⾏注⼊"><a href="#如何进⾏注⼊" class="headerlink" title="如何进⾏注⼊"></a>如何进⾏注⼊</h3><ul>
<li>类的成员变量提供set get⽅法</li>
<li>配置spring的配置⽂件</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"com.mk.learn.spring.ioc.module.User"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>AAA1111<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"123"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>测试类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mk.learn.spring.ioc.spring;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mk.learn.spring.ioc.<span class="keyword">module</span>.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@program</span>: learning-demo</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>:</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: mk_passby</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span>: 2020-09-13 21:34</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringIocTest</span>  </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(</span><br><span class="line">            <span class="string">"springIoc.xml"</span>);</span><br><span class="line">        User user = (User) applicationContext.getBean(<span class="string">"user"</span>);</span><br><span class="line">        System.out.println(<span class="string">"user.getName() = "</span> + user.getName());</span><br><span class="line">        System.out.println(<span class="string">"user.getAge() = "</span> + user.getAge());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="常用的注入方式"><a href="#常用的注入方式" class="headerlink" title="常用的注入方式"></a>常用的注入方式</h3><h4 id="JDK类型"><a href="#JDK类型" class="headerlink" title="JDK类型"></a>JDK类型</h4><ul>
<li>数组/List集合</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">value</span>&gt;</span>AAA<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">value</span>&gt;</span>BBBB<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">value</span>&gt;</span>CCC<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Set集合</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">value</span>&gt;</span>AAA<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">value</span>&gt;</span>BBBB<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">value</span>&gt;</span>CCC<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Map集合</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">key</span>&gt;</span><span class="tag">&lt;<span class="name">value</span>&gt;</span>AA<span class="tag">&lt;/<span class="name">value</span>&gt;</span><span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">value</span>&gt;</span>CCCC<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">key</span>&gt;</span><span class="tag">&lt;<span class="name">value</span>&gt;</span>AA1<span class="tag">&lt;/<span class="name">value</span>&gt;</span><span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">"XXXX"</span>/&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Properites</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;props&gt;</span><br><span class="line"> &lt;prop key=&quot;key1&quot;&gt;value1&lt;/prop&gt;</span><br><span class="line"> &lt;prop key=&quot;key2&quot;&gt;value2&lt;/prop&gt;</span><br><span class="line">&lt;/props&gt;</span><br></pre></td></tr></table></figure>
<h4 id="⽤户⾃定义类型"><a href="#⽤户⾃定义类型" class="headerlink" title="⽤户⾃定义类型"></a>⽤户⾃定义类型</h4><ul>
<li>直接配置bean对象注入<ul>
<li>为成员变量提供set get⽅法</li>
<li>配置⽂件中进⾏注⼊</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userService"</span> <span class="attr">class</span>=<span class="string">"xxxx.UserServiceImpl"</span>&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"userDAO"</span>&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"xxx.UserDAOImpl"</span>/&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>使用ref指向bean</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userDAO"</span> <span class="attr">class</span>=<span class="string">"xxx.UserDAOImpl"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userService"</span> <span class="attr">class</span>=<span class="string">"xxx.UserServiceImpl"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"userDAO"</span>&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">"userDAO"</span>/&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="Set注⼊的简化写法"><a href="#Set注⼊的简化写法" class="headerlink" title="Set注⼊的简化写法"></a>Set注⼊的简化写法</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"aaa"</span>&gt;</span></span></span><br><span class="line"> 	<span class="xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span></span>CCCC<span class="xml"><span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> 	可以简化为</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"aaa"</span> <span class="attr">value</span>=<span class="string">"CCCC"</span>/&gt;</span></span></span><br><span class="line"></span><br><span class="line">-------------------------------</span><br><span class="line">⽤户⾃定义类型</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"userDAO"</span>&gt;</span></span></span><br><span class="line"> 	<span class="xml"><span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">"userDAO"</span>/&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="code">	可以简化为</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"userDAO"</span> <span class="attr">ref</span>=<span class="string">"userDAO"</span>/&gt;</span></span></span><br><span class="line"></span><br><span class="line">-------------------------------</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"person"</span> <span class="attr">class</span>=<span class="string">"xxxx.Person"</span>&gt;</span></span></span><br><span class="line"> <span class="xml"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span>&gt;</span></span></span><br><span class="line"> 	<span class="xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span></span>AAA<span class="xml"><span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"> <span class="xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span></span><br><span class="line"><span class="code">	可以简化为(需要引入命名空间p标签)</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"person"</span> <span class="attr">class</span>=<span class="string">"xxx.Person"</span> <span class="attr">p:name</span>=<span class="string">"AAA"</span>/&gt;</span></span></span><br><span class="line"></span><br><span class="line">---------------------------------</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userService"</span> <span class="attr">class</span>=<span class="string">"xx.UserServiceImpl"</span>&gt;</span></span></span><br><span class="line"><span class="code">	&lt;property name="userDAO"&gt;</span></span><br><span class="line"> 		<span class="xml"><span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">"userDAO"</span>/&gt;</span></span></span><br><span class="line"> 	<span class="xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span></span><br><span class="line"><span class="code">	可以简化为(需要引入命名空间p标签)</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userService"</span> <span class="attr">class</span>=<span class="string">"xxx.UserServiceImpl"</span> <span class="attr">p:userDAO-ref</span>=<span class="string">"userDAO"</span>/&gt;</span></span></span><br></pre></td></tr></table></figure>
<h4 id="构造注⼊"><a href="#构造注⼊" class="headerlink" title="构造注⼊"></a>构造注⼊</h4><ul>
<li>参数个数不同时通过控制<code>&lt;constructor-arg&gt;</code>标签的数量进⾏区分</li>
<li>构造参数个数相同时,通过在标签引⼊ type属性 进⾏类型的区分<code>&lt;constructor-arg type=&quot;&quot;&gt;</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConstructorModule</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> String naem;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConstructorModule</span><span class="params">(<span class="keyword">int</span> age, String naem)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">this</span>.naem = naem;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--构造器注入--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"constructorDemo"</span> <span class="attr">class</span>=<span class="string">"com.mk.learn.spring.ioc.module.ConstructorModule"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">"123"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">"AAAA"</span>/&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="Spring⼯⼚创建复杂对象"><a href="#Spring⼯⼚创建复杂对象" class="headerlink" title="Spring⼯⼚创建复杂对象"></a>Spring⼯⼚创建复杂对象</h2><ul>
<li>复杂对象：指的就是不能直接通过new构造⽅法创建的对象(Connection,SqlSessionFactory)</li>
</ul>
<h3 id="Spring⼯⼚创建复杂对象的3种⽅式"><a href="#Spring⼯⼚创建复杂对象的3种⽅式" class="headerlink" title="Spring⼯⼚创建复杂对象的3种⽅式"></a>Spring⼯⼚创建复杂对象的3种⽅式</h3><h4 id="1-FactoryBean接⼝"><a href="#1-FactoryBean接⼝" class="headerlink" title="1.FactoryBean接⼝"></a>1.FactoryBean接⼝</h4><ul>
<li>实现FactoryBean接⼝</li>
<li>Spring内部运⾏流程<ol>
<li>通过conn获得ConnectionFactoryBean类的对象 ，进⽽通过instanceof 判断出是FactoryBean接⼝的实现类</li>
<li>Spring按照规定 getObject() —&gt;Connection</li>
<li>返回Connection</li>
</ol>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mk.learn.spring.ioc.<span class="keyword">module</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.FactoryBean;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@program</span>: learning-demo</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>:</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: mk_passby</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span>: 2020-09-13 22:26</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConnectionFactoryBean</span> <span class="keyword">implements</span> <span class="title">FactoryBean</span>&lt;<span class="title">Connection</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Connection <span class="title">getObject</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Class.forName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line">        Connection connection= DriverManager.getConnection(</span><br><span class="line">            <span class="string">"jdbc:mysql://localhost:3306/test?useSSL=false"</span>,</span><br><span class="line">            <span class="string">"root"</span>,</span><br><span class="line">            <span class="string">"xxxx"</span>);</span><br><span class="line">        <span class="keyword">return</span> connection;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Class&lt;?&gt; getObjectType() &#123;</span><br><span class="line">        <span class="keyword">return</span> Connection.class;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isSingleton</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-实例⼯⼚"><a href="#2-实例⼯⼚" class="headerlink" title="2.实例⼯⼚"></a>2.实例⼯⼚</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"connFactory"</span> <span class="attr">class</span>=<span class="string">"com.mk.learn.spring.ioc.module.ConnectionFactoryBean"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"conn"</span> <span class="attr">factorybean</span>=<span class="string">"connFactory"</span> <span class="attr">factorymethod</span>=<span class="string">"getConnection"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="3-静态⼯⼚"><a href="#3-静态⼯⼚" class="headerlink" title="3.静态⼯⼚"></a>3.静态⼯⼚</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"conn"</span> <span class="attr">class</span>=<span class="string">"com.mk.learn.spring.ioc.module.ConnectionFactoryBean"</span>  <span class="attr">factorymethod</span>=<span class="string">"getConnection"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="控制Spring⼯⼚创建对象的次数"><a href="#控制Spring⼯⼚创建对象的次数" class="headerlink" title="控制Spring⼯⼚创建对象的次数"></a>控制Spring⼯⼚创建对象的次数</h2><h3 id="简单对象的创建次数"><a href="#简单对象的创建次数" class="headerlink" title="简单对象的创建次数"></a>简单对象的创建次数</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"account"</span> <span class="attr">scope</span>=<span class="string">"singleton|prototype"</span> <span class="attr">class</span>=<span class="string">"xxxx.Account"</span>/&gt;</span></span></span><br><span class="line"><span class="code">	sigleton:只会创建⼀次简单对象 默认值</span></span><br><span class="line"><span class="code">	prototype:每⼀次都会创建新的对象</span></span><br></pre></td></tr></table></figure>
<h3 id="复杂对象的创建次数"><a href="#复杂对象的创建次数" class="headerlink" title="复杂对象的创建次数"></a>复杂对象的创建次数</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">FactoryBean&#123;</span><br><span class="line"> isSingleton()&#123;</span><br><span class="line"> 	return true 只会创建⼀次</span><br><span class="line"> 	return false 每⼀次都会创建新的</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="code">	如没有isSingleton⽅法 还是通过scope属性 进⾏对象创建次数的控制</span></span><br></pre></td></tr></table></figure>

        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>

        <div id="lv-container">
        </div>

    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        
        <li>
            <a target="_blank"  href="https://github.com/mk-passby">
                            <span class="fa-stack fa-lg">
                                <i class="iconfont icon-github"></i>
                            </span>
            </a>
        </li>
        

        

    </ul>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a href="https://hexo.io/">Hexo</a>  Theme <a href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


    <script>
        /**
         *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
         *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
        */
        if( '' || '')
        var disqus_config = function () {
            this.page.url = '';  // Replace PAGE_URL with your page's canonical URL variable
            this.page.identifier = ''; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        };

        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');
            s.src = 'https://airclouds-blog.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>



</html>
